{"ast":null,"code":"// Copyright (c) Quinntyne Brown. All Rights Reserved.\n// Licensed under the MIT License. See License.txt in the project root for license information.\nimport { Subject } from 'rxjs';\nimport { FormControl, FormGroup, Validators, ReactiveFormsModule } from \"@angular/forms\";\nimport { AuthService } from '../../core/services/auth.service';\nimport { takeUntil, map } from 'rxjs/operators';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { isProblemDetails } from '../../core/problem-details';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { Button } from '../../components/button/button';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core/services/auth.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/material/icon\";\nfunction LoginDialog_div_14_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Username is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginDialog_div_14_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Password is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginDialog_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, LoginDialog_div_14_div_3_Template, 2, 0, \"div\", 8)(4, LoginDialog_div_14_div_4_Template, 2, 0, \"div\", 8);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.errorMessage, \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.form.controls[\"username\"].hasError(\"required\"));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.form.controls[\"password\"].hasError(\"required\"));\n  }\n}\nexport let LoginDialog = /*#__PURE__*/(() => {\n  class LoginDialog {\n    constructor(_authService, _dialogRef) {\n      this._authService = _authService;\n      this._dialogRef = _dialogRef;\n      this.onDestroy = new Subject();\n      this.form = new FormGroup({\n        username: new FormControl(null, [Validators.required]),\n        password: new FormControl(null, [Validators.required])\n      });\n    }\n    close() {\n      this._dialogRef.close();\n    }\n    tryToLogin() {\n      if (this.form.valid) {\n        this._authService.tryToLogin({\n          username: this.form.value.username,\n          password: this.form.value.password\n        }).pipe(takeUntil(this.onDestroy), map(x => {\n          if (isProblemDetails(x)) {\n            this.errorMessage = 'Invalid Username or Password.';\n          } else {\n            this._dialogRef.close();\n          }\n        })).subscribe();\n      } else {\n        this.errorMessage = 'Missing required fields.';\n      }\n    }\n    ngOnDestroy() {\n      this.onDestroy.next();\n    }\n    handleInputFocus() {\n      this.errorMessage = '';\n    }\n    static {\n      this.ɵfac = function LoginDialog_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || LoginDialog)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.MatDialogRef));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: LoginDialog,\n        selectors: [[\"kth-login-dialog\"]],\n        decls: 15,\n        vars: 3,\n        consts: [[3, \"click\"], [\"novalidate\", \"\", \"autocomplete\", \"off\", \"spellcheck\", \"false\", 3, \"formGroup\"], [1, \"field\"], [\"type\", \"text\", \"formControlName\", \"username\", \"required\", \"\", 3, \"focus\"], [\"type\", \"password\", \"formControlName\", \"password\", \"required\", \"\", 3, \"focus\"], [3, \"click\", \"text\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"error-message\"], [4, \"ngIf\"]],\n        template: function LoginDialog_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"mat-icon\", 0);\n            i0.ɵɵlistener(\"click\", function LoginDialog_Template_mat_icon_click_0_listener() {\n              return ctx.close();\n            });\n            i0.ɵɵtext(1, \"close\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(2, \"h2\");\n            i0.ɵɵtext(3, \"Login\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"form\", 1)(5, \"div\", 2)(6, \"label\");\n            i0.ɵɵtext(7, \"Username:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"input\", 3);\n            i0.ɵɵlistener(\"focus\", function LoginDialog_Template_input_focus_8_listener() {\n              return ctx.handleInputFocus();\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(9, \"div\", 2)(10, \"label\");\n            i0.ɵɵtext(11, \"Password:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"input\", 4);\n            i0.ɵɵlistener(\"focus\", function LoginDialog_Template_input_focus_12_listener() {\n              return ctx.handleInputFocus();\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(13, \"kth-button\", 5);\n            i0.ɵɵlistener(\"click\", function LoginDialog_Template_kth_button_click_13_listener() {\n              return ctx.tryToLogin();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(14, LoginDialog_div_14_Template, 5, 3, \"div\", 6);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"formGroup\", ctx.form);\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"text\", \"Login\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n          }\n        },\n        dependencies: [CommonModule, i3.NgIf, ReactiveFormsModule, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.FormGroupDirective, i4.FormControlName, MatIconModule, i5.MatIcon, Button],\n        styles: [\"[_nghost-%COMP%]{background-color:#fff;display:block;min-width:400px;max-width:calc(100% - 40px);padding:20px 0}form[_ngcontent-%COMP%]{display:grid;grid-row-gap:10px;max-width:800px;margin:20px}.field[_ngcontent-%COMP%]{display:grid;grid-template-columns:100px 1fr;margin:0 20px 15px}input[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{line-height:24pt}input[_ngcontent-%COMP%]{padding:0 12px;-webkit-appearance:none;border:solid 1px;border-radius:0}kth-button[_ngcontent-%COMP%]{width:100%;margin:0;display:block}h2[_ngcontent-%COMP%]{margin:20px 0 0 20px}mat-icon[_ngcontent-%COMP%]{cursor:pointer;margin:0 20px}kth-button[_ngcontent-%COMP%]{margin:0 auto}\"]\n      });\n    }\n  }\n  return LoginDialog;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}